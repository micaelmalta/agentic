# Developer Workflow Diagram

Visual representation of the complete developer workflow orchestration.

---

## High-Level Flow

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                           DEVELOPER WORKFLOW (ORCHESTRATOR)                              │
│                                                                                          │
│  Trigger: /workflow, "implement feature", "fix bug", "refactor"                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 1: PLAN                                                            Skills: para   │
│                                                                         architect (opt) │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐          │
│   │   Explore    │    │   Explore    │    │    Bash      │    │   Explore    │          │
│   │  (affected   │    │  (patterns)  │    │ (git history)│    │   (tests)    │          │
│   │   files)     │    │              │    │              │    │              │          │
│   └──────┬───────┘    └──────┬───────┘    └──────┬───────┘    └──────┬───────┘          │
│          │                   │                   │                   │                   │
│          └───────────────────┴───────────────────┴───────────────────┘                   │
│                                          │                                               │
│                                          ▼                                               │
│                        ┌─────────────────────────────────┐                               │
│                        │  Create Plan Document           │                               │
│                        │  context/plans/YYYY-MM-DD-*.md  │                               │
│                        │  (use tech_proposal_template    │                               │
│                        │   for architecture changes)     │                               │
│                        └─────────────────────────────────┘                               │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
                              ┌───────────────────────┐
                              │   USER APPROVAL GATE  │◄──── Plan rejected? Revise
                              └───────────────────────┘
                                          │ Approved
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 2: BRANCH                                                                          │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│   If Jira ticket: transition to In Progress (Atlassian MCP)                             │
│   git checkout -b feature/<name> or fix/<name>                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 3: EXECUTE                                                      Skills: developer │
│                                                                               debugging  │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌─────────────────────────────────────────────────────────────────────────────────┐   │
│   │                        TDD: RED-GREEN-REFACTOR CYCLE                            │   │
│   │                                                                                  │   │
│   │   ┌─────────┐         ┌─────────┐         ┌─────────┐         ┌─────────┐       │   │
│   │   │  RED    │────────▶│  RUN    │────────▶│  GREEN  │────────▶│  RUN    │       │   │
│   │   │ Write   │         │  TEST   │         │ Write   │         │  TEST   │       │   │
│   │   │ failing │         │ (fails) │         │ minimum │         │(passes) │       │   │
│   │   │ test    │         │         │         │ code    │         │         │       │   │
│   │   └─────────┘         └─────────┘         └─────────┘         └────┬────┘       │   │
│   │                                                                    │            │   │
│   │                                                                    ▼            │   │
│   │                                                             ┌─────────┐         │   │
│   │         ◄───────────────────────────────────────────────────│REFACTOR │         │   │
│   │         │            (repeat for each behavior)             │ Clean   │         │   │
│   │         │                                                   │ up code │         │   │
│   │         │                                                   └─────────┘         │   │
│   │         ▼                                                                       │   │
│   │   ┌─────────────────────────────────────────────────────────────────────────┐   │   │
│   │   │ FEATURE: Tests define behavior first                                    │   │   │
│   │   │ BUG FIX: Write reproduction test first (debugging skill)                │   │   │
│   │   │ REFACTOR: Ensure tests exist, then modify                               │   │   │
│   │   └─────────────────────────────────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                          │
│   For large codebases (100+ files): Use RLM skill for parallel implementation           │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 4: TESTING                                                       Skills: testing  │
│                                                                             Playwright  │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐          │
│   │    Bash      │    │    Bash      │    │   General    │    │  Playwright  │          │
│   │  Run unit    │    │  Run build   │    │   purpose    │    │  MCP (E2E)   │          │
│   │   tests      │    │              │    │  Edge cases  │    │  (if UI)     │          │
│   └──────┬───────┘    └──────┬───────┘    └──────┬───────┘    └──────┬───────┘          │
│          │                   │                   │                   │                   │
│          └───────────────────┴───────────────────┴───────────────────┘                   │
│                                          │                                               │
│                                          ▼                                               │
│                         ┌────────────────────────────────┐                               │
│                         │  All tests pass?               │                               │
│                         │  Build succeeds?               │                               │
│                         └────────────────────────────────┘                               │
│                                          │                                               │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                              ┌───────────────────────┐
                              │   TESTS PASS GATE     │◄──── Tests fail? Fix and retry
                              └───────────────────────┘
                                          │ All pass
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 5: VALIDATION                                            Skills: code-reviewer    │
│                                                                       security-reviewer │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐          │
│   │    Bash      │    │    Bash      │    │   General    │    │   General    │          │
│   │   Linter     │    │    Build     │    │   purpose    │    │   purpose    │          │
│   │              │    │              │    │ Code Review  │    │Security Rev  │          │
│   └──────┬───────┘    └──────┬───────┘    └──────┬───────┘    └──────┬───────┘          │
│          │                   │                   │                   │                   │
│          └───────────────────┴───────────────────┴───────────────────┘                   │
│                                          │                                               │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                              ┌───────────────────────┐
                              │  VALIDATION GATE      │◄──── Issues? Fix and retry
                              └───────────────────────┘
                                          │ All pass
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 6: COMMIT                                                    Skills: git-commits  │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│   git add <files> && git commit -m "<type>(<scope>): <summary>" && git push -u origin   │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 7: PR                                                                              │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│   gh pr create --draft --title "..." --body "..."  After all commits: gh pr ready       │
│   Jira: link PR; transition ticket to In Code Review (Atlassian MCP)                   │
└─────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│ PHASE 8: MONITOR, SUMMARIZE & CLEANUP                             Skills: para          │
│                                                                         documentation   │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│   ┌──────────────────────────────────────────────────────────────────────────────────┐  │
│   │ ONE-PASS CI/BOT MONITORING                                                       │  │
│   │                                                                                  │  │
│   │  Check CI status (once) → Check bot comments (once)                             │  │
│   │         │                         │                                             │  │
│   │         ├─ All green ─────────────┴──► Skip to Summary                          │  │
│   │         │                                                                        │  │
│   │         └─ Failures/Comments                                                    │  │
│   │                  │                                                              │  │
│   │                  ▼                                                              │  │
│   │           Simple/Automatable? ────YES──► Auto-fix + Push (ONCE)                │  │
│   │                  │                           │                                  │  │
│   │                  NO                          ▼                                  │  │
│   │                  │                   Still fails? ──► Escalate to user          │  │
│   │                  ▼                                                              │  │
│   │           Escalate to user                                                      │  │
│   │           (AskUserQuestion with options)                                        │  │
│   │                                                                                  │  │
│   │  Simple: format, lint --fix, trivial test config, dependency lockfile          │  │
│   │  Complex: logic errors, design feedback, security, perf, breaking changes      │  │
│   └──────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                          │
│   After PR merge:                                                                        │
│   /summarize → context/summaries/YYYY-MM-DD-*.md                                         │
│   Update docs (if needed) → Parallel subagents for README/API/ADR                       │
│   Clean up worktree: git worktree remove <path>                                         │
│   /archive when complete                                                                │
└─────────────────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
                              ┌───────────────────────┐
                              │      COMPLETE         │
                              │  - Merged PR URL      │
                              │  - Summary document   │
                              │  - Tests confirmed    │
                              └───────────────────────┘
```

---

## Skill Dependencies

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                    SKILL DEPENDENCIES                                    │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                                    ┌──────────┐                                          │
│                                    │ workflow │ (orchestrator)                           │
│                                    └────┬─────┘                                          │
│                                         │                                                │
│          ┌──────────────────────────────┼──────────────────────────────┐                │
│          │                              │                              │                │
│          ▼                              ▼                              ▼                │
│    ┌──────────┐                  ┌──────────┐                   ┌──────────┐            │
│    │   para   │                  │developer │                   │ testing  │            │
│    │(planning)│                  │  (TDD)   │                   │(validate)│            │
│    └──────────┘                  └────┬─────┘                   └────┬─────┘            │
│          │                            │                              │                  │
│          ▼                            │                              ▼                  │
│    ┌──────────┐                       │                        ┌──────────┐            │
│    │architect │                       │                        │Playwright│            │
│    │(tech spec)                       │                        │  (E2E)   │            │
│    └──────────┘                       │                        └──────────┘            │
│                                       │                                                 │
│                    ┌──────────────────┼──────────────────┐                             │
│                    │                  │                  │                             │
│                    ▼                  ▼                  ▼                             │
│              ┌──────────┐      ┌──────────┐      ┌──────────┐                          │
│              │debugging │      │refactoring│     │git-commits│                         │
│              │(bug+test)│      │(safe edit)│     │ (commit)  │                         │
│              └──────────┘      └──────────┘      └──────────┘                          │
│                                                                                          │
│    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐        │
│    │  code-   │    │security- │    │  docs    │    │   deps   │    │   perf   │        │
│    │ reviewer │    │ reviewer │    │          │    │          │    │          │        │
│    └──────────┘    └──────────┘    └──────────┘    └──────────┘    └──────────┘        │
│                                                                                          │
│    ┌──────────┐    ┌──────────┐                                                         │
│    │  ci-cd   │    │   rlm    │ (for 100+ file codebases)                               │
│    └──────────┘    └──────────┘                                                         │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## MCP Integrations

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              MCP INTEGRATIONS                                            │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌────────────┐     ┌────────────┐     ┌────────────┐                                  │
│   │ Atlassian  │     │  Datadog   │     │ Playwright │                                  │
│   │            │     │            │     │            │                                  │
│   │ • Jira     │     │ • Logs     │     │ • E2E      │                                  │
│   │ • Conflu.  │     │ • Metrics  │     │ • UI tests │                                  │
│   │            │     │ • Traces   │     │ • Visual   │                                  │
│   └─────┬──────┘     └─────┬──────┘     └─────┬──────┘                                  │
│         │                  │                  │                                          │
│         ▼                  ▼                  ▼                                          │
│   Plan, PR phases    Debugging, CI/CD    Testing (mandatory                             │
│                                          if UI exists)                                   │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## TDD Cycle Detail

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              TDD: RED-GREEN-REFACTOR                                     │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│                              ┌─────────────────┐                                         │
│                              │                 │                                         │
│                              │    1. RED       │                                         │
│                              │  Write failing  │                                         │
│                              │     test        │                                         │
│                              │                 │                                         │
│                              └────────┬────────┘                                         │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌─────────────────┐                                         │
│                              │   Run test      │                                         │
│                              │   (must FAIL)   │                                         │
│                              └────────┬────────┘                                         │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌─────────────────┐                                         │
│                              │                 │                                         │
│                              │   2. GREEN      │                                         │
│                              │  Write minimum  │                                         │
│                              │  code to pass   │                                         │
│                              │                 │                                         │
│                              └────────┬────────┘                                         │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌─────────────────┐                                         │
│                              │   Run test      │                                         │
│                              │   (must PASS)   │                                         │
│                              └────────┬────────┘                                         │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌─────────────────┐                                         │
│                              │                 │                                         │
│                              │  3. REFACTOR    │                                         │
│                              │   Clean up      │                                         │
│                              │   (tests stay   │                                         │
│                              │    green)       │                                         │
│                              │                 │                                         │
│                              └────────┬────────┘                                         │
│                                       │                                                  │
│                                       ▼                                                  │
│                              ┌─────────────────┐                                         │
│                              │  More behaviors │──────┐                                  │
│                              │  to implement?  │      │ Yes                              │
│                              └────────┬────────┘      │                                  │
│                                       │ No            │                                  │
│                                       ▼               │                                  │
│                              ┌─────────────────┐      │                                  │
│                              │     DONE        │◄─────┘                                  │
│                              └─────────────────┘      (loop back to RED)                 │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Task Type Flows

### Feature Implementation

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              FEATURE IMPLEMENTATION                                      │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   1. Break feature into behaviors                                                        │
│                    │                                                                     │
│                    ▼                                                                     │
│   2. For each behavior:                                                                  │
│      ┌─────────────────────────────────────────────────────────────────┐                │
│      │  Write test → Run (FAIL) → Write code → Run (PASS) → Refactor  │                │
│      └─────────────────────────────────────────────────────────────────┘                │
│                    │                                                                     │
│                    ▼                                                                     │
│   3. All behaviors implemented                                                           │
│                    │                                                                     │
│                    ▼                                                                     │
│   4. Proceed to validation                                                               │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

### Bug Fix

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                    BUG FIX                                               │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   1. Understand the bug (symptoms, steps)                                                │
│                    │                                                                     │
│                    ▼                                                                     │
│   2. Write reproduction test                                                             │
│      ┌─────────────────────────────────────────────────────────────────┐                │
│      │  Test exercises buggy code path                                 │                │
│      │  Assert EXPECTED (correct) behavior                             │                │
│      │  Test must FAIL (proving bug exists)                            │                │
│      └─────────────────────────────────────────────────────────────────┘                │
│                    │                                                                     │
│                    ▼                                                                     │
│   3. Fix the root cause (minimal change)                                                 │
│                    │                                                                     │
│                    ▼                                                                     │
│   4. Run reproduction test (must PASS)                                                   │
│                    │                                                                     │
│                    ▼                                                                     │
│   5. Run all tests (no regressions)                                                      │
│                    │                                                                     │
│                    ▼                                                                     │
│   6. Proceed to validation                                                               │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

### Refactoring

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                   REFACTORING                                            │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   1. Verify tests exist for code being changed                                           │
│      (if not, write them FIRST)                                                          │
│                    │                                                                     │
│                    ▼                                                                     │
│   2. Run tests (establish PASSING baseline)                                              │
│                    │                                                                     │
│                    ▼                                                                     │
│   3. Make ONE small refactoring change                                                   │
│                    │                                                                     │
│                    ▼                                                                     │
│   4. Run tests (must still PASS)                                                         │
│                    │                                                                     │
│                    ├──────────────────┐                                                  │
│                    │                  │ More changes?                                    │
│                    ▼                  │                                                  │
│   5. Done ◄───────────────────────────┘ (loop back to step 3)                           │
│                                                                                          │
│   Golden Rule: Behavior UNCHANGED, tests PASS before and after                           │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Parallel Execution Patterns

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                           PARALLEL EXECUTION PATTERNS                                    │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│  PHASE 1 (Exploration):                                                                  │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐                                 │
│  │ Explore  │  │ Explore  │  │   Bash   │  │ Explore  │   ← Run in parallel             │
│  │  files   │  │ patterns │  │git history│  │  tests   │                                 │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘                                 │
│       └─────────────┴─────────────┴─────────────┘                                        │
│                          │                                                               │
│                          ▼                                                               │
│                    Consolidate                                                           │
│                                                                                          │
│  PHASE 4 (Testing):                                                                      │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐                                 │
│  │  Unit    │  │  Build   │  │Edge cases│  │   E2E    │   ← Run in parallel             │
│  │  tests   │  │          │  │  tests   │  │(Playwrt) │                                 │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘                                 │
│       └─────────────┴─────────────┴─────────────┘                                        │
│                          │                                                               │
│                          ▼                                                               │
│                  All must pass                                                           │
│                                                                                          │
│  PHASE 5 (Validation):                                                                   │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐                                 │
│  │  Linter  │  │  Build   │  │  Code    │  │ Security │   ← Run in parallel             │
│  │          │  │          │  │  Review  │  │  Review  │                                 │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘                                 │
│       └─────────────┴─────────────┴─────────────┘                                        │
│                          │                                                               │
│                          ▼                                                               │
│                  All must pass                                                           │
│                                                                                          │
│  SEQUENTIAL (cannot parallelize):                                                        │
│  ┌──────────┐     ┌──────────┐     ┌──────────┐                                         │
│  │debugging │ ──▶ │refactoring│ ──▶ │git-commits│  ← Must run in order                  │
│  └──────────┘     └──────────┘     └──────────┘                                         │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Blocking Gates with Feedback Loops

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                         BLOCKING GATES WITH RETRY LOOPS                                  │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   Gate 1: USER APPROVAL (after Phase 1)                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────────┐       │
│   │  Present Plan ──► Approved? ──► YES ──► Proceed to Phase 2                  │       │
│   │       ▲               │                                                     │       │
│   │       │              NO                                                     │       │
│   │       │               │                                                     │       │
│   │       │               ▼                                                     │       │
│   │       └────── Revise Plan ◄── Get User Feedback                            │       │
│   └─────────────────────────────────────────────────────────────────────────────┘       │
│                                                                                          │
│   Gate 2: TESTS PASS (after Phase 4) ⚠️ MANDATORY RETRY LOOP                            │
│   ┌─────────────────────────────────────────────────────────────────────────────┐       │
│   │  Run All Tests ──► All Pass? ──► YES ──► Proceed to Phase 5                 │       │
│   │       ▲                │                                                    │       │
│   │       │               NO                                                    │       │
│   │       │                │                                                    │       │
│   │       │                ▼                                                    │       │
│   │       │       Identify Failures                                             │       │
│   │       │                │                                                    │       │
│   │       │                ▼                                                    │       │
│   │       │         Fix Issues ──► Same failure 3x? ──► Ask User               │       │
│   │       │                │                                                    │       │
│   │       └────────────────┘                                                    │       │
│   │                                                                             │       │
│   │   Checks: Unit ✓ Integration ✓ E2E ✓ Build ✓                               │       │
│   └─────────────────────────────────────────────────────────────────────────────┘       │
│                                                                                          │
│   Gate 3: VALIDATION (after Phase 5) ⚠️ MANDATORY RETRY LOOP                            │
│   ┌─────────────────────────────────────────────────────────────────────────────┐       │
│   │  Run Validations ──► All Pass? ──► YES ──► Proceed to Phase 6              │       │
│   │       ▲                  │                                                  │       │
│   │       │                 NO                                                  │       │
│   │       │                  │                                                  │       │
│   │       │                  ▼                                                  │       │
│   │       │         ┌───────┴───────┐                                          │       │
│   │       │         │               │                                          │       │
│   │       │      Linter?      Security?                                        │       │
│   │       │         │               │                                          │       │
│   │       │         ▼               ▼                                          │       │
│   │       │     Auto-fix      ⛔ STOP if                                       │       │
│   │       │     + Manual      vulnerability                                    │       │
│   │       │         │         (escalate)                                       │       │
│   │       └─────────┴───────────────┘                                          │       │
│   │                                                                             │       │
│   │   Checks: Linter ✓ Build ✓ Code Review ✓ Security ✓                        │       │
│   └─────────────────────────────────────────────────────────────────────────────┘       │
│                                                                                          │
│   ⛔ WORKFLOW STOPS at each gate until ALL requirements are met                          │
│   ⚠️ NEVER skip a failing check - ALWAYS fix and retry                                  │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Feedback Loop Logic (Pseudocode)

### Testing Gate Loop (Phase 4)

```
function runTestingGate():
    retryCount = 0
    lastFailure = null

    WHILE true:
        results = runAllTests()  // unit, integration, e2e, build

        IF results.allPass:
            return SUCCESS  // Proceed to Phase 5

        failures = results.getFailures()

        IF failures == lastFailure:
            retryCount++
            IF retryCount >= 3:
                askUser("Same failure 3 times. Need guidance.")
                retryCount = 0
        ELSE:
            retryCount = 0
            lastFailure = failures

        FOR each failure in failures:
            analyzeFailure(failure)
            fixCode(failure)  // NOT the test, unless test is wrong

        // Loop continues - re-run all tests
    END WHILE
```

### Validation Gate Loop (Phase 5)

```
function runValidationGate():
    retryCount = 0

    WHILE true:
        // Run all validations in parallel
        lintResult = runLinter()
        buildResult = runBuild()
        codeReview = runCodeReview()
        securityReview = runSecurityReview()

        IF all pass:
            return SUCCESS  // Proceed to Phase 6

        // Handle each failure type
        IF lintResult.failed:
            runAutoFix()  // npm run lint --fix
            manualFixRemaining()

        IF buildResult.failed:
            fixCompilationErrors()

        IF securityReview.failed:
            IF canFix(securityReview.issues):
                fixVulnerabilities()
            ELSE:
                STOP("Security vulnerability cannot be auto-fixed")
                escalateToUser()
                WAIT for user decision

        IF codeReview.failed:
            addressFeedback()

        retryCount++
        IF retryCount >= 3 AND sameFailures:
            askUser("Validation failing repeatedly. Need guidance.")

        // Loop continues - re-run all validations
    END WHILE
```

### TDD Cycle Loop (Phase 3)

```
function runTDDCycle(behaviors):
    FOR each behavior in behaviors:
        // RED phase
        test = writeFailingTest(behavior)
        result = runTest(test)

        WHILE result != FAIL:
            // Test should fail - if it passes, test is wrong
            fixTest(test)
            result = runTest(test)
        END WHILE

        // GREEN phase
        WHILE result != PASS:
            writeMinimumCode()
            result = runTest(test)

            IF sameFailure 3 times:
                askUser("Can't make test pass. Need help.")
        END WHILE

        // REFACTOR phase
        WHILE canRefactor():
            refactorCode()
            result = runAllTests()

            IF result != ALL_PASS:
                undoRefactor()
                break
        END WHILE
    END FOR

    return SUCCESS
```

---

## Escalation Decision Tree

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                            ESCALATION DECISION TREE                                      │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   Issue Detected                                                                         │
│        │                                                                                 │
│        ▼                                                                                 │
│   Can auto-fix? ──► YES ──► Auto-fix ──► Re-run ──► Pass? ──► YES ──► Continue         │
│        │                                              │                                  │
│       NO                                             NO                                  │
│        │                                              │                                  │
│        ▼                                              ▼                                  │
│   Can manual fix? ──► YES ──► Manual fix ──► Re-run ──► Pass? ──► YES ──► Continue     │
│        │                                                │                                │
│       NO                                               NO                                │
│        │                                                │                                │
│        ▼                                                ▼                                │
│   Security issue? ──► YES ──► ⛔ STOP WORKFLOW                                          │
│        │                      Escalate to user                                          │
│       NO                      Wait for decision                                         │
│        │                                                                                 │
│        ▼                                                                                 │
│   Retry count >= 3? ──► YES ──► Ask user for guidance                                   │
│        │                        Reset retry count                                       │
│       NO                        Continue with user input                                │
│        │                                                                                 │
│        ▼                                                                                 │
│   Increment retry                                                                        │
│   Try again                                                                              │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## Quick Reference

| Phase         | Skills Used                      | Parallel?         | Gate          | Retry Loop?                  |
| ------------- | -------------------------------- | ----------------- | ------------- | ---------------------------- |
| 1. Plan       | para, architect                  | Yes (exploration) | User approval | Yes (revise until approved)  |
| 2. Branch     | -                                | No                | -             | No                           |
| 3. Execute    | developer, debugging             | TDD cycle         | -             | Yes (TDD cycle per behavior) |
| 4. Testing    | testing, Playwright              | Yes               | Tests pass    | **Yes (MANDATORY)**          |
| 5. Validation | code-reviewer, security-reviewer | Yes               | All pass      | **Yes (MANDATORY)**          |
| 6. Commit     | git-commits                      | No                | -             | No                           |
| 7. PR         | -                                | No                | -             | No                           |
| 8. Monitor    | para, documentation              | Yes (docs)        | -             | No (one-pass only)           |

### Retry Loop Rules

| Gate            | Max Retries | Escalation                       |
| --------------- | ----------- | -------------------------------- |
| User Approval   | Unlimited   | User provides feedback           |
| TDD Cycle       | Unlimited   | Ask after 3 same failures        |
| Testing Gate    | Unlimited   | Ask after 3 same failures        |
| Validation Gate | Unlimited   | STOP on unfixable security issue |

---

## Key Principles

| Concept         | Description                                               |
| --------------- | --------------------------------------------------------- |
| **Workflow**    | Pure orchestrator - coordinates skills, doesn't implement |
| **Developer**   | All implementation via TDD (Red-Green-Refactor)           |
| **Gates**       | Blocking checkpoints - must pass before proceeding        |
| **Retry Loops** | MANDATORY at gates - fix and re-run until all pass        |
| **Escalation**  | Ask user after 3 same failures; STOP on security issues   |
| **Parallel**    | Independent tasks run simultaneously                      |
| **Sequential**  | debugging → refactoring → git-commits must run in order   |

### Retry Loop Guarantees

1. **Never skip a failing check** - Always fix and retry
2. **Never proceed with errors** - Gates are blocking
3. **Always re-run ALL checks** - Not just the failed one
4. **Escalate when stuck** - Ask user after 3 same failures
5. **Document retries** - Log each attempt and fix in summary
